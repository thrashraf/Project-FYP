{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\n\nconst initialState = () => ({\n  user: null,\n  isFetching: false,\n  isSuccess: false,\n  isError: false,\n  errorMessage: \"\"\n});\n\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState: initialState(),\n  reducers: {\n    login: (state, action) => {\n      state.user = action.payload;\n    },\n    logout: state => {\n      state.user = null;\n    },\n    clearState: state => initialState()\n  },\n  extraReducers: builder => {\n    builder.addCase(signupUser.fulfilled, (state, _ref) => {\n      let {\n        payload\n      } = _ref;\n      state.isFetching = false;\n      state.isSuccess = true;\n    });\n    builder.addCase(signupUser.pending, state => {\n      state.isFetching = true;\n    });\n    builder.addCase(signupUser.rejected, (state, _ref2) => {\n      let {\n        payload\n      } = _ref2;\n      state.isFetching = false;\n      state.isError = true;\n      state.errorMessage = payload.message;\n    });\n    builder.addCase(loginUser.fulfilled, (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      state.isFetching = false;\n      state.isSuccess = true;\n    });\n    builder.addCase(loginUser.pending, state => {\n      state.isFetching = true;\n    });\n    builder.addCase(loginUser.rejected, (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      state.isFetching = false;\n      state.isError = true;\n      state.errorMessage = payload.message;\n    });\n  }\n});\nexport const signupUser = createAsyncThunk(\"users/signupUser\", async (_ref5, thunkAPI) => {\n  let {\n    name,\n    email,\n    password\n  } = _ref5;\n\n  try {\n    const response = await fetch(\"/api/user/register\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        name,\n        email,\n        password\n      })\n    });\n    let data = await response.json();\n\n    if (response.status === 200) {\n      console.log(\"data\", data);\n    } else {\n      return thunkAPI.rejectWithValue(data);\n    }\n  } catch (e) {\n    console.log(\"Error\", e.response.data);\n    return thunkAPI.rejectWithValue(e.response.data);\n  }\n});\nexport const loginUser = createAsyncThunk(\"users/login\", async (_ref6, thunkAPI) => {\n  let {\n    email,\n    password\n  } = _ref6;\n\n  try {\n    const response = await fetch(\"/api/user/login\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email,\n        password\n      })\n    });\n    let data = await response.json();\n    console.log(\"response\", data);\n\n    if (response.status === 200) {\n      localStorage.setItem(\"token\", data.token);\n      return data;\n    } else {\n      return thunkAPI.rejectWithValue(data);\n    }\n  } catch (e) {\n    console.log(\"Error\", e.response.data);\n    thunkAPI.rejectWithValue(e.response.data);\n  }\n});\nexport const {\n  login,\n  logout,\n  clearState\n} = userSlice.actions;\nexport const userSelector = state => state.user;\nexport default userSlice.reducer;","map":{"version":3,"sources":["C:/Users/Asus/Desktop/PROJECT/Project-FYP/frontend/src/features/user/User.tsx"],"names":["createAsyncThunk","createSlice","initialState","user","isFetching","isSuccess","isError","errorMessage","userSlice","name","reducers","login","state","action","payload","logout","clearState","extraReducers","builder","addCase","signupUser","fulfilled","pending","rejected","message","loginUser","thunkAPI","email","password","response","fetch","method","headers","Accept","body","JSON","stringify","data","json","status","console","log","rejectWithValue","e","localStorage","setItem","token","actions","userSelector","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport { RootState } from \"../../app/Store\";\r\n\r\ninterface user {\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nconst initialState = () => ({\r\n  user: null,\r\n  isFetching: false,\r\n  isSuccess: false,\r\n  isError: false,\r\n  errorMessage: \"\",\r\n});\r\n\r\nexport const userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: initialState(),\r\n  reducers: {\r\n    login: (state, action) => {\r\n      state.user = action.payload;\r\n    },\r\n    logout: (state) => {\r\n      state.user = null;\r\n    },\r\n    clearState: (state) => initialState(),\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase(signupUser.fulfilled, (state, { payload }: any) => {\r\n      state.isFetching = false;\r\n      state.isSuccess = true;\r\n    });\r\n    builder.addCase(signupUser.pending, (state) => {\r\n      state.isFetching = true;\r\n    });\r\n    builder.addCase(signupUser.rejected, (state, { payload }: any) => {\r\n      state.isFetching = false;\r\n      state.isError = true;\r\n      state.errorMessage = payload.message;\r\n    });\r\n    builder.addCase(loginUser.fulfilled, (state, { payload }: any) => {\r\n        state.isFetching = false;\r\n        state.isSuccess = true;\r\n      });\r\n      builder.addCase(loginUser.pending, (state) => {\r\n        state.isFetching = true;\r\n      });\r\n      builder.addCase(loginUser.rejected, (state, { payload }: any) => {\r\n        state.isFetching = false;\r\n        state.isError = true;\r\n        state.errorMessage = payload.message;\r\n      });\r\n  },\r\n});\r\n\r\nexport const signupUser = createAsyncThunk(\r\n  \"users/signupUser\",\r\n  async ({ name, email, password }: user, thunkAPI) => {\r\n    try {\r\n      const response = await fetch(\"/api/user/register\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          name,\r\n          email,\r\n          password,\r\n        }),\r\n      });\r\n      let data = await response.json();\r\n\r\n      if (response.status === 200) {\r\n        console.log(\"data\", data);\r\n      } else {\r\n        return thunkAPI.rejectWithValue(data);\r\n      }\r\n    } catch (e: any) {\r\n      console.log(\"Error\", e.response.data);\r\n      return thunkAPI.rejectWithValue(e.response.data);\r\n    }\r\n  }\r\n);\r\n\r\n\r\n\r\nexport const loginUser = createAsyncThunk(\r\n    \"users/login\",\r\n    async ({ email, password }\r\n        \r\n        , thunkAPI) => {\r\n      try {\r\n        const response = await fetch(\r\n          \"/api/user/login\",\r\n          {\r\n            method: \"POST\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n              email,\r\n              password,\r\n            }),\r\n          }\r\n        )\r\n        let data = await response.json()\r\n        console.log(\"response\", data)\r\n        if (response.status === 200) {\r\n          localStorage.setItem(\"token\", data.token)\r\n          return data\r\n        } else {\r\n          return thunkAPI.rejectWithValue(data)\r\n        }\r\n      } catch (e) {\r\n        console.log(\"Error\", e.response.data)\r\n        thunkAPI.rejectWithValue(e.response.data)\r\n      }\r\n    }\r\n  )\r\n\r\n\r\n\r\n\r\nexport const { login, logout, clearState } = userSlice.actions;\r\nexport const userSelector = (state: RootState) => state.user;\r\nexport default userSlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}